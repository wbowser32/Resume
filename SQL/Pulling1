SELECT distinct  
                                
                                OH.order_no                   As Staples_order_no, 

                                oh.CUSTOMER_PO_NO             AS External_Document_No,  

                                oh.bill_to_id                 AS Sell_to_Customer_no, 
                                
                                YOH.ORDER_NO                  AS Vendor_PO#,  

                                oh.EXTN_CUST_COMPANY_NAME     AS customer_name, 

                                opi.state                     AS Ship_To_State,  

                                opi.zip_code                  AS ZipCode,  

                                yp.payment_Type               AS method_of_payment,  

                                orstat.status                 AS status,  

                                ys.description                as Status_Description,  

                                ol.original_ordered_qty,  

                                case when orstat.status  in ('3700.01','3700.02','3700.50')then orstat.status_quantity*(-1)
                                else orstat.status_quantity end AS status_quantity,  

                                ssd.ship_node                 as Ship_Node,  
                                
                                ol.unit_price,                                   
                                
                                ol.unit_price*ol.Ordered_Qty  AS Merchandize$,  

                                ole.decimal_3                 AS Marketplace_TAX,  

                                ol.tax                        AS staples_TAX,  

                                ssd.shipment_type             AS Shipment_Type,  

                                ysn.description               AS WhoelsalerName_Vendor#_FC#,  
                                
                                ole.Text_19                   AS NAV_Id,  

                                ol.item_id                    AS staples_Item_No,   
                                
                                ssd.Shipped_Item_Id,  
                                
                                ol.extn_vendor_part_number    AS Vendor_Part_No,  
                                                      
                                ol.customer_item              AS EXTERNAL_ITEM_NO,   
                                 
                                (Select IDP.dptnam from PRD_USD_OPV.SUNBEAM_MMBASLIB_INVDPT_V IDP WHERE idp.idept = i.Iidept and IDP.ISDEPT = 0        AND IDP.ICLAS = 0        AND IDP.ISCLAS=0 )    AS Item_Department,
                                
                                (select IDP.dptnam from PRD_USD_OPV.SUNBEAM_MMBASLIB_INVDPT_V IDP WHERE idp.idept = i.Iidept and idp.isdept = i.iisdpt AND IDP.ICLAS = 0        AND IDP.ISCLAS=0 AND IDP.Dptpln  <>'†††††     ')      AS Item_Division,
                                
                                (select IDP.dptnam from PRD_USD_OPV.SUNBEAM_MMBASLIB_INVDPT_V IDP WHERE idp.idept = i.Iidept AND idp.isdept = i.iisdpt AND IDP.ICLAS = i.iiclas AND IDP.ISCLAS=0 and IDP.Dptpln  <>'†††††     ')      AS Item_Class,
                     
                                (select wb.navid from htch_rpt.WBTEST wb where wb.navid = ole.Text_19) as WBTEST,
                                
                                (select ob.Obsolete_SKU from htch_rpt.obsolete_sku ob where to_char(ob.Obsolete_SKU) = ol.item_id ) as Obsolete_sku,
                                
                                (select ob.Obsolete_Min from htch_rpt.obsolete_sku ob where to_char(ob.Obsolete_SKU) = ol.item_id ) as Obsolete_min,
                                
                                ol.Level_Of_Service,  
                                
                               --  sh.Tracking_Num,
                                
                               --  (select sh.tracking_num from prd_usd_opv.CUSTEXO_CEX01_OWN_EPTS_SHIPMENT_V sh where sh.order_num = oh.order_no and ol.Level_Of_Service= 'SFP')as sfp_tracking_num ,
                                
                                ssd.Scac,  
                                
                                ssd.Zone_Number,  
                                
                                MP.SKU as PROMO,  
                                
                                MP.StartDate as PROMO_Startdt,  
                                
                                MP.StopDate as PROMO_Stopdt,                          
                                
                                ol.Unit_Cost,  
                                
                                ol.unit_cost * ol.ordered_Qty AS Ext_Cost,  
                                
                                ol.unit_cost * orstat.status_quantity AS PO_Cost_Ext,    
                                
--                             ((ol.unit_price*ol.Ordered_Qty) - (ol.Unit_Cost*ol.Ordered_Qty))/(ol.unit_price*ol.Ordered_Qty) AS Gross_Margin,

--                             (((ol.unit_price*ol.Ordered_Qty) - (ol.Unit_Cost*ol.Ordered_Qty))/(ol.unit_price*ol.Ordered_Qty))*100 AS Gross_Mar_Perc,

                                ol.ordered_Qty                AS Quantity,   

                                ol.extn_accounting_loc        AS Accounting_location,   

                                oh.createts                   AS Create_date,                             
                  
                                ssd.ship_date                 AS SHIP_Date, 

                                ssd.del_date                  AS Delivery_date 
                                                      
    FROM PRD_USD_OPV.SOMS_YFS_ORDER_HEADER_V oh  
                                INNER JOIN PRD_USD_OPV.SOMS_YFS_ORDER_LINE_V ol   
                                                ON oh.order_header_key = ol.order_header_key    
                                
                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_YFS_ORDER_release_status_V orstat   
                                                ON ol.order_line_key = orstat.order_line_key    
                                                AND orstat.status_quantity>0   
                                
                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_YFS_PERSON_INFO_V opi   
                                                ON oh.ship_to_key = opi.person_info_key   
                                
                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_SPLS_SHIPMENT_DETAILS_V ssd   
                                                ON ol.order_line_key=ssd.orderline_key   
                                                AND ssd.status NOT IN('InActive')   
                                
                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_YFS_ORDER_HEADER_EXTENSION_V OHE  
                                                ON OHE.Order_Header_Key = oh.Order_Header_Key  

                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_YFS_ORDER_LINE_EXTENSION_V ole   
                                                ON ol.order_line_key=ole.order_line_key    

                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_YFS_PAYMENT_V yp   
                                                ON oh.order_header_key=yp.order_header_key  

                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_YFS_STATUS_V ys   
                                                ON  orstat.status=ys.status    

                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_YFS_SHIP_NODE_V ysn  
                                                ON ssd.ship_node=trim(ysn.ship_node) 
                                                
                                LEFT OUTER JOIN PRD_USD_OPV.SUNRISE_MMBASLIB_SDITEM_V  I 
                                                On ssd.shipped_Item_id = to_char(I."IISKU#")
                                                
                                LEFT OUTER JOIN PRD_USD_OPV.SOMS_YFS_ORDER_LINE_V YOL 
                                                ON  YOL.chained_from_order_header_key = oh.Order_Header_Key
                                                                                                  
                                LEFT OUTER JOIN  PRD_USD_OPV.SOMS_YFS_ORDER_HEADER_V YOH 
                                                ON YOH.ordeR_header_key    =YOL.Order_Header_Key      
                                                
                                LEFT OUTER JOIN HTCH_RPT.MARKETPLACE_PROMO MP 
                                                ON MP.Internal_No = ole.Text_19
                                               
WHERE  
      oh.extn_order_channel = 'HITOUCH' 
      and OHE.Text_11 ='HTCH3'
      
--    and ol.Item_Id in ('990119',	'136815',	'2260271',	'24328579',	'365384',	'787385',	'923523',	'24398920',	'24328573',	'825695',	'24328570',	'1677790',	'116657',	'2262751',	'2554455',	'24398921',	'24396773',	'2715724',	'934103',	'649243',	'2257054',	'1104593',	'24328571',	'447139',	'2630432',	'24311722',	'221689',	'163865',	'24328578',	'487908',	'24328575',	'24311967',	'887836',	'2710763',	'24396771',	'2554454',	'2832045',	'2719542',	'24328568',	'486330',	'187021',	'394057',	'24380329',	'24311727',	'1775861',	'937975',	'1678457',	'163840',	'266759',	'187039',	'1200191',	'934100',	'2829384',	'266262',	'24311723',	'379479',	'2258153',	'163360',	'24380328',	'2722088',	'24311720',	'418335',	'24311726',	'24311719',	'24405546',	'744100',	'479884',	'1682169',	'381970',	'163873',	'24311724',	'24411133',	'1190098',	'708147',	'1922857',	'2715730',	'186999',	'1682171',	'24398961',	'491789',	'561162',	'24411132',	'24411130',	'201350',	'24377968',	'875411',	'24381063',	'24310335',	'24323552',	'24328569',	'24311725',	'418343',	'479880',	'24398959',	'24382038',	'756927',	'24388638',	'24377876',	'24380330',	'567297',	'24398918',	'1682292',	'379476',	'1899090',	'2710774',	'1694263',	'690748',	'24398962',	'396444',	'567296',	'418293',	'24411131',	'2094913',	'230344',	'24405544',	'24394010',	'756928',	'1678497',	'1682170',	'479872',	'418319',	'224519',	'424154',	'24411134',	'567300',	'24388640',	'121962',	'1798334',	'24377969',	'380806',	'892099',	'24375263',	'224527',	'224543',	'24375256',	'2720173',	'570225',	'24375272',	'849372',	'24375267',	'247445',	'472902',	'759400',	'199984',	'535062',	'886653',	'534990',	'1170835',	'440374',	'535021',	'399451',	'24374957',	'2707824',	'422618',	'1798333',	'594413',	'594412',	'634797',	'194969',	'1682316',	'227132',	'24353925',	'489561',	'535112',	'573945',	'1682315',	'167056',	'280354',	'849398',	'918765',	'2072175',	'690747',	'293050',	'422675',	'396445',	'440373',	'541092',	'479878',	'886217',	'725508',	'609121',	'1798335',	'24398946',	'24374954',	'638805',	'711382',	'430603',	'535070',	'886232',	'534800',	'24383526',	'418210',	'2072174',	'24398953',	'24394126',	'772968',	'2072216',	'2846119',	'772966',	'511509',	'24374956',	'534701',	'919350',	'333054',	'24444923',	'24448174',	'24448177',	'24443010',	'714405',	'807983',	'24328149',	'1694095',	'2072157',	'911864',	'24376920',	'24377030',	'486573',	'704789',	'2072168',	'2321360',	'24376917',	'24377016',	'24377019',	'24377024',	'24394045',	'122374',	'24386707',	'24395857',	'2256786',	'24439518',	'64690',	'122408',	'24386708',	'24342683',	'2730549',	'2091512',	'324021',	'1979189',	'2764645',	'24383778',	'2646682',	'2767069',	'223885',	'24393601',	'24298470',	'1259330',	'790760',	'209882',	'478740',	'24395090',	'571863',	'482898',	'24422901',	'917881',	'887359',	'24423682',	'24432780',	'24384937',	'607841',	'582962',	'917860',	'24373335',	'805252',	'2847075',	'24399059',	'2509329',	'24359672',	'369657',	'125328',	'57256',	'823292',	'483018',	'464050',	'1684921',	'24422900',	'892639',	'2518072',	'792257',	'2724237',	'2140557',	'478405',	'1539761',	'2764644',	'24330113',	'865543',	'701218',	'491294',	'24393549',	'1385482',	'24342684',	'2636742',	'1611322',	'2259351',	'24394807',	'24313764',	'807176',	'661825',	'2848608',	'24359319',	'784551',	'329507',	'2259350',	'117468',	'1635475',	'130005',	'271674',	'518986',	'24356640',	'2634339',	'2070271',	'482998',	'24373334',	'41302',	'703356',	'416780',	'867474',	'429174',	'24398915',	'1635473',	'24365372',	'344887',	'946196',	'1417713',	'442901',	'2240683',	'77278',	'329509',	'703715',	'487226',	'424575',	'558255',	'2428194',	'618374',	'707198',	'2837131',	'50552',	'1440295',	'385550',	'707196',	'490199',	'24369206',	'1235594',	'469080',	'865670',	'618854',	'117439',	'2739895',	'376423',	'504308',	'595555',	'206709',	'50551',	'24375278',	'382692',	'865839',	'415489',	'483072',	'869097',	'24311794',	'731846',	'454291',	'784615',	'374490',	'1635472',	'719614',	'260273',	'1181122',	'260265',	'495492',	'796630',	'617433',	'2077444',	'377179',	'565339',	'2429322',	'707197',	'1913050',	'760457',	'910546',	'236240',	'2802493',	'609710',	'719413',	'31307',	'808343',	'1417706',	'108985',	'24383780',	'2438163',	'1667670',	'569577',	'936975',	'356654',	'2432877',	'823326',	'1582341',	'356652',	'894633',	'438073',	'503573',	'689309',	'886654',	'464819',	'867473',	'465930',	'513246',	'558253',	'616841',	'284190',	'36619',	'514879',	'211540',	'504023',	'564950',	'642736',	'565004',	'886404',	'332893',	'454299',	'262691',	'471514',	'1611323',	'202184',	'506790',	'424576',	'2406182',	'869101',	'228452',	'563076',	'648103',	'377181',	'807177',	'648102',	'79511',	'521163',	'554359',	'492757',	'2658108',	'796637',	'615725',	'755958',	'611564',	'592678',	'322834',	'611568',	'219763',	'2655724',	'219916',	'681466',	'681465',	'598509',	'120741',	'168492',	'229990',	'9063231',	'9483967',	'9063223',	'9483975',	'8452062',	'8845646',	'7937253',	'7935240',	'7845365',	'9717018',	'9713173',	'9716994',	'9716986',	'9716978',	'9716960',	'8353641',	'5277645',	'9012352',	'8807737',	'8344376',	'8344350',	'8344335',	'9085028',	'9119231',	'6230643',	'9026428',	'8401127',	'8401044',	'8401002',	'8400962',	'8400947',	'8456063',	'8416950',	'9144734',	'9584699',	'8453961',	'8478943',	'8756009',	'8755993',	'8755985',	'9065335',	'8763807',	'9136003',	'8475485',	'5086525',	'8447575',	'9269655',	'9232208',	'9581752',	'7826928',	'8732984',	'8733743',	'7888555',	'8733610',	'9723255',	'9639949',	'8803009',	'8755944',	'8562225',	'8644346',	'9130089',	'9056565',	'7769268',	'9157850',	'9004953',	'4774857',	'9201088',	'4826442',	'7773674',	'5031687',	'8792871',	'8804023',	'7854466',	'5259106',	'8378408',	'9163593',	'8988743',	'5642871',	'5083084',	'9028424',	'9632449',	'4999876',	'4903811',	'9707035',	'9681529',	'4887840',	'9076340',	'5017306',	'8348039',	'8958175',	'9065053',	'8990061',	'8989592',	'8758211',	'9368499',	'9294786',	'9096892',	'8460560',	'8346983',	'7822661',	'7683857',	'7893092',	'8856064',	'9398355',	'8926503',	'8926354',	'7807878',	'9246117',	'7949464',	'7949480',	'9206384',	'9215690',	'8855264',	'8475899',	'8438913',	'9305988',	'8594434',	'8635302',	'8847287',	'8734238',	'8470593',	'9063488',	'8634974',	'9063116',	'9073586',	'7834161',	'9073578',	'9062662',	'9491820',	'9938911',	'9503780',	'8945933',	'7744394',	'8945925',	'8855249',	'9070954',	'8348237',	'9070939',	'8471799',	'8738486',	'8738528',	'8366999',	'8855884',	'9127069',	'9126038',	'9000621',	'8757783',	'7735335',	'8344780',	'8342677',	'8335697',	'9069907',	'8353427',	'8353310',	'9690546',	'7895584',	'8367153',	'8755720',	'8788903',	'8472839',	'9925298',	'8847501',	'5293956',	'7800014',	'7800030',	'7800063',	'7800071',	'9386731',	'9390188',	'4772406',	'4910824',	'8855462',	'8855454',	'8855447',	'8957433',	'7774839',	'9026584',	'9026576',	'8855702',	'9436197',	'9033655',	'8904229',	'9072570',	'9528472',	'9528423',	'8855710',	'7856354',	'9974767',	'8420606',	'9168063',	'8729147',	'9398322',	'8729311',	'8729329',	'7669013',	'7809916',	'7668973',	'7668965',	'8851099',	'9307190',	'9035957',	'7703291',	'8737967',	'7710148',	'9804428',	'9615782',	'9070327',	'8391567',	'9581968',	'9079740',	'9065525',	'9698838',	'9211533',	'ALECC4219',	'ALECS4351',	'ALEEBE4217',	'ALEEL4215',	'ALEEL42ME10B',	'ALEEL4314',	'ALEEL4614',	'ALEELT4214F',	'ALEET4017B',	'ALEET42ME10B',	'ALEFANP16B',	'ALEFT726018MY',	'ALEFT727218MY',	'ALEGR364818BL',	'ALELG41ME10B',	'ALELMP557AB',	'ALELTD4824WA',	'ALENR4119',	'ALENR4206',	'ALENR4219',	'ALERL2219M',	'ALERL4319M',	'ALERL4351M',	'ALERL43C16',	'ALERV44LS10C',	'ALESP41LS10B',	'ALESR41LS10B',	'ALESW59SL3618',	'ALESW59SL4818',	'ALETT6030WG',	'ALEVA572816ES',	'ALEVN4119',	'ALEYR4119',	'BWK1336',	'BWK1490',	'BWK2GALBAG',	'BWK32GREEN',	'BWK340LP',	'BWK386016',	'BWK410320',	'BWK410321',	'BWK410323',	'BWK519',	'BWK523',	'BWK526',	'BWK603',	'BWK609',	'BWK6101',	'BWK6102',	'BWK6145',	'BWK6180',	'BWK6200',	'BWK6210',	'BWK6212',	'BWK6220',	'BWK6252',	'BWK6254B',	'BWK6256',	'BWK6272',	'BWK6400',	'BWK6405',	'BWK6415',	'BWK6500B',	'BWK8311CT',	'BWK926YEA',	'BWK951TEA',	'BWKHL365BSPC',	'BWKJRT1000',	'BWKK5000',	'BWKU04CT',	'GEN9JUMBOB',	'GEN1511',	'GEN1513',	'GEN1800',	'GEN1820',	'GEN1825',	'GEN1827',	'GEN202',	'GEN203',	'GEN218',	'GEN29B',	'GEN500',	'GEN6501',	'GENMULTIFOLDWH',	'GENULTRA9B',	'IVR39501',	'IVR39502',	'IVR51441',	'IVR51450',	'IVR51451',	'IVR72810',	'IVR81900',	'IVRF280A',	'JAGIW2432R',	'JAGR3858HH',	'JAGW2432X',	'UNV00116',	'UNV00132',	'UNV00133',	'UNV00164',	'UNV00432',	'UNV10200VP',	'UNV10201',	'UNV10202',	'UNV10203',	'UNV10211',	'UNV10280',	'UNV10290',	'UNV10291',	'UNV10300',	'UNV10301',	'UNV10302',	'UNV10303',	'UNV10304',	'UNV10311',	'UNV10312',	'UNV10313',	'UNV10318',	'UNV10451',	'UNV10630',	'UNV11381',	'UNV12113',	'UNV13120',	'UNV13420',	'UNV14221',	'UNV15703',	'UNV15802',	'UNV15807',	'UNV15852',	'UNV16466',	'UNV17000',	'UNV20003',	'UNV20027',	'UNV20435',	'UNV20453',	'UNV20630',	'UNV21125',	'UNV21127',	'UNV30730',	'UNV30755',	'UNV35210',	'UNV35260',	'UNV35264',	'UNV35267',	'UNV35270',	'UNV35300',	'UNV35615',	'UNV35715',	'UNV35850',	'UNV35854',	'UNV36004',	'UNV36005',	'UNV36301',	'UNV36321',	'UNV38026',	'UNV40102',	'UNV40304VP',	'UNV40318',	'UNV43023',	'UNV43033',	'UNV43604',	'UNV43613',	'UNV43618',	'UNV43619',	'UNV43622',	'UNV43623',	'UNV43624',	'UNV43626',	'UNV43627',	'UNV43629',	'UNV43714',	'UNV43724',	'UNV43735',	'UNV43743',	'UNV44636',	'UNV45600',	'UNV46300',	'UNV47215',	'UNV54071',	'UNV54095',	'UNV63000',	'UNV76848',	'UNV81525',	'UNV83412',	'UNV85120',	'UNV85300',	'UNV95200',	'UNV96920PK',	'UNV35600')
--    and oh.order_header_key  between 
--    ( select
--                           cast(cast(fy_strt_dt as date format 'yyyymmdd') as varchar(8)) 
--                        from  PRD_GDW_BUV.FSC_CAL_V 
--                            where  cal_dt = current_date) 
--        and cast(cast(Current_Date as date format 'yyyymmdd') as varchar(8))

  and oh.document_type      = '0001'  
  and ys.process_type_key   = 'ORDER_FULFILLMENT' 
--  and oh.Customer_Po_No in ('4803089043962',	'7803089039300',	'4803089034802',	'7803089029966',	'6806779672762',	'2803089026371',	'1806779652458',	'4803089000918',	'2803088992398',	'4803088984984',	'4803088984983',	'3806779628401',	'6806779611104',	'2803088964380',	'1806779601349',	'6806779587899',	'2803088935148',	'1806779578074',	'7803088948863',	'7803088929412',	'1806779573001',	'4803088924650',	'4803088924077',	'4803088916810',	'2803088906880',	'2803088897974',	'6806779513523',	'6806779511768',	'3806779504233',	'6806779500810',	'4803088850280',	'6806779476470',	'7803088803439',	'6806779404912',	'7803088758240',	'3806779383845',	'7803088733811',	'6806779111089',	'1806779091626',	'7803088445395',	'2803088433491',	'3806779071914',	'4803088425540',	'4803088425012',	'7803088410098',	'3806779046167',	'6806779043606',	'7803088396593',	'6806779037728',	'3806778987495',	'6806778987077',	'4803088318709',	'7803088276870',	'2803088275068',	'4803088272306',	'6806768913458',	'6806768893614',	'1806768878377',	'7803078224939',	'4803078214386',	'4803078177266',	'7803078143962',	'6806768788325',	'6806768782164',	'1806768773561',	'2803078118565',	'3806768759116',	'7803078112069',	'7803078109859',	'3806768707351',	'2803078051925',	'3806768693593',	'6806768687126',	'2803078034495',	'3806768663882',	'4803078014047',	'4803077995662',	'7803077982235',	'3806768612632',	'3806768594826',	'2803077961904',	'2803077960649',	'3806768538554',	'7803077888153',	'6806768519796',	'7803077869989',	'2803077825450',	'6806768444546',	'1806768443770',	'2803077790570',	'6806768398879',	'6806768398879',	'6806768373619',	'3806768369540',	'1806768357537',	'3806768353375',	'3806768348016',	'6806768337105',	'3806768336127',	'7803077686969',	'1806768315311',	'1806768314935',	'2803067648635',	'6806758273782',	'3806758253244',	'3806758243092',	'4803067571874',	'1806758204326',	'4803067561769',	'3806758164672',	'2803067518778',	'4803067517682',	'2803067516288',	'3806758144975',	'7803067491885',	'1806758115994',	'2803067464484',	'2803067409559',	'7803067402393',	'4803067395360',	'1806758040418',	'4803067397732',	'4803067397732',	'4803067380629',	'2803067380552',	'1806757997257',	'2803067355594',	'3806757984958',	'6806757982409',	'3806757967155',	'4803067326870',	'4803067305070',	'4803067284245',	'4803067276043',	'4803067243501',	'4803067222110',	'6806757887720',	'1806757830141',	'2803067196261',	'3806757808631',	'2803067155194',	'4803067145247',	'3806757759135',	'3806747721862',	'1806747695015',	'2803057044087',	'4803056522219',	'4803056488461',	'1806736897990',	'3806736677466',	'4803000593428')
  and oh.order_header_key between -- '20201101' and '20201129'
  
  (select
                           cast(cast(fsp_strt_dt as date format 'yyyymmdd') as varchar(8)) 
                       from PRD_GDW_BUV.FSC_CAL_V
                            where  cal_dt = current_date) 
  and
  cast(cast(Current_Date+1 as date format 'yyyymmdd') as varchar(8))
  
  order by oh.order_no;
  
  
  
 
 
 
